<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>八爪鱼小站</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="八爪鱼小站">
    <meta name="referrer" content="never">
    
    <link rel="preload" href="/assets/css/0.styles.e4025035.css" as="style"><link rel="preload" href="/assets/js/app.984fdec4.js" as="script"><link rel="preload" href="/assets/js/2.f6007b26.js" as="script"><link rel="preload" href="/assets/js/49.22b61fb9.js" as="script"><link rel="prefetch" href="/assets/js/10.59cdb2f4.js"><link rel="prefetch" href="/assets/js/11.4e8427de.js"><link rel="prefetch" href="/assets/js/12.7a10184b.js"><link rel="prefetch" href="/assets/js/13.083a4586.js"><link rel="prefetch" href="/assets/js/14.b100d612.js"><link rel="prefetch" href="/assets/js/15.08fdb981.js"><link rel="prefetch" href="/assets/js/16.808ce394.js"><link rel="prefetch" href="/assets/js/17.c6489116.js"><link rel="prefetch" href="/assets/js/18.8f683b57.js"><link rel="prefetch" href="/assets/js/19.e3c29ff0.js"><link rel="prefetch" href="/assets/js/20.73eecd32.js"><link rel="prefetch" href="/assets/js/21.701951a2.js"><link rel="prefetch" href="/assets/js/22.2013c06b.js"><link rel="prefetch" href="/assets/js/23.957e09cd.js"><link rel="prefetch" href="/assets/js/24.7c713358.js"><link rel="prefetch" href="/assets/js/25.0e6a82f8.js"><link rel="prefetch" href="/assets/js/26.a05ee402.js"><link rel="prefetch" href="/assets/js/27.cf387aa5.js"><link rel="prefetch" href="/assets/js/28.10b336a1.js"><link rel="prefetch" href="/assets/js/29.f95ddc62.js"><link rel="prefetch" href="/assets/js/3.57a28cbb.js"><link rel="prefetch" href="/assets/js/30.0c819ce6.js"><link rel="prefetch" href="/assets/js/31.edb82535.js"><link rel="prefetch" href="/assets/js/32.0da353ea.js"><link rel="prefetch" href="/assets/js/33.b2156d6b.js"><link rel="prefetch" href="/assets/js/34.3b32512e.js"><link rel="prefetch" href="/assets/js/35.c588f8e0.js"><link rel="prefetch" href="/assets/js/36.b306573c.js"><link rel="prefetch" href="/assets/js/37.d0c3967d.js"><link rel="prefetch" href="/assets/js/38.81b57a9f.js"><link rel="prefetch" href="/assets/js/39.e1a6ecaf.js"><link rel="prefetch" href="/assets/js/4.0495b111.js"><link rel="prefetch" href="/assets/js/40.3d350cf1.js"><link rel="prefetch" href="/assets/js/41.11e9c39c.js"><link rel="prefetch" href="/assets/js/42.01710931.js"><link rel="prefetch" href="/assets/js/43.8474ba10.js"><link rel="prefetch" href="/assets/js/44.ede483ee.js"><link rel="prefetch" href="/assets/js/45.fe2a4bf2.js"><link rel="prefetch" href="/assets/js/46.688bd2c0.js"><link rel="prefetch" href="/assets/js/47.c405d292.js"><link rel="prefetch" href="/assets/js/48.7f5d7cad.js"><link rel="prefetch" href="/assets/js/5.b3f55925.js"><link rel="prefetch" href="/assets/js/50.315d590f.js"><link rel="prefetch" href="/assets/js/51.304a8e2f.js"><link rel="prefetch" href="/assets/js/52.dc01aad1.js"><link rel="prefetch" href="/assets/js/53.ed974a2f.js"><link rel="prefetch" href="/assets/js/54.3f8ea4f6.js"><link rel="prefetch" href="/assets/js/55.63aef931.js"><link rel="prefetch" href="/assets/js/56.714a0542.js"><link rel="prefetch" href="/assets/js/57.071c0df4.js"><link rel="prefetch" href="/assets/js/58.725c2ccb.js"><link rel="prefetch" href="/assets/js/59.b7faeb7b.js"><link rel="prefetch" href="/assets/js/6.5385b4bb.js"><link rel="prefetch" href="/assets/js/60.8f4b2b12.js"><link rel="prefetch" href="/assets/js/61.eeb76448.js"><link rel="prefetch" href="/assets/js/7.5d579fc3.js"><link rel="prefetch" href="/assets/js/8.44873d68.js"><link rel="prefetch" href="/assets/js/9.937d4458.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4025035.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">八爪鱼小站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/blog/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/JavaScript/" class="nav-link">
  JavaScript高级语法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/node/01_base.html" class="nav-link">
  node基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/02_scaffold.html" class="nav-link">
  脚手架的实现
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/03_express.html" class="nav-link">
  express核心用法
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/04_koa.html" class="nav-link">
  koa核心用法
</a></li></ul></div></div><div class="nav-item"><a href="/blog/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端架构" class="dropdown-title"><span class="title">前端架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端架构" class="mobile-dropdown-title"><span class="title">前端架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/前端架构/GithubActions.html" class="nav-link">
  Github Actions
</a></li><li class="dropdown-item"><!----> <a href="/blog/前端架构/Docker.html" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="web" class="dropdown-title"><span class="title">web</span> <span class="arrow down"></span></button> <button type="button" aria-label="web" class="mobile-dropdown-title"><span class="title">web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/web/html.html" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/regular.html" class="nav-link">
  正则
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/network.html" class="nav-link">
  网络协议
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/mobile.html" class="nav-link">
  移动端
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/optimize.html" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><h4>
          浏览器工作原理与实践
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/web/browser/01.html" class="nav-link">
  01.Chrome架构：仅仅打开了1个页面，为什么有4个进程？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/02.html" class="nav-link">
  02.TCP协议：如何保证页面文件能被完整送达浏览器？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/03.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  03.HTTP 请求流程：为什么很多站点第二次打开速度会很快？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/04.html" class="nav-link">
  04.导航流程：从输入URL到页面展示，这中间发生了什么？
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/linux/" class="nav-link">
  linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="案例库" class="dropdown-title"><span class="title">案例库</span> <span class="arrow down"></span></button> <button type="button" aria-label="案例库" class="mobile-dropdown-title"><span class="title">案例库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/case/article-collects.html" class="nav-link">
  文章收集
</a></li><li class="dropdown-item"><!----> <a href="/blog/case/dry-goods.html" class="nav-link">
  前端开发干货
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档教程" class="dropdown-title"><span class="title">文档教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档教程" class="mobile-dropdown-title"><span class="title">文档教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.imooc.com/wiki/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  慕课教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  菜鸟教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/blog/tutorial/03.印记中文.html" class="nav-link">
  印记中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/blog/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/blog/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/JavaScript/" class="nav-link">
  JavaScript高级语法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/node/01_base.html" class="nav-link">
  node基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/02_scaffold.html" class="nav-link">
  脚手架的实现
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/03_express.html" class="nav-link">
  express核心用法
</a></li><li class="dropdown-item"><!----> <a href="/blog/node/04_koa.html" class="nav-link">
  koa核心用法
</a></li></ul></div></div><div class="nav-item"><a href="/blog/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端架构" class="dropdown-title"><span class="title">前端架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端架构" class="mobile-dropdown-title"><span class="title">前端架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/前端架构/GithubActions.html" class="nav-link">
  Github Actions
</a></li><li class="dropdown-item"><!----> <a href="/blog/前端架构/Docker.html" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="web" class="dropdown-title"><span class="title">web</span> <span class="arrow down"></span></button> <button type="button" aria-label="web" class="mobile-dropdown-title"><span class="title">web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/web/html.html" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/regular.html" class="nav-link">
  正则
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/network.html" class="nav-link">
  网络协议
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/mobile.html" class="nav-link">
  移动端
</a></li><li class="dropdown-item"><!----> <a href="/blog/web/optimize.html" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><h4>
          浏览器工作原理与实践
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/web/browser/01.html" class="nav-link">
  01.Chrome架构：仅仅打开了1个页面，为什么有4个进程？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/02.html" class="nav-link">
  02.TCP协议：如何保证页面文件能被完整送达浏览器？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/03.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  03.HTTP 请求流程：为什么很多站点第二次打开速度会很快？
</a></li><li class="dropdown-subitem"><a href="/blog/web/browser/04.html" class="nav-link">
  04.导航流程：从输入URL到页面展示，这中间发生了什么？
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/linux/" class="nav-link">
  linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="案例库" class="dropdown-title"><span class="title">案例库</span> <span class="arrow down"></span></button> <button type="button" aria-label="案例库" class="mobile-dropdown-title"><span class="title">案例库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/case/article-collects.html" class="nav-link">
  文章收集
</a></li><li class="dropdown-item"><!----> <a href="/blog/case/dry-goods.html" class="nav-link">
  前端开发干货
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档教程" class="dropdown-title"><span class="title">文档教程</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档教程" class="mobile-dropdown-title"><span class="title">文档教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.imooc.com/wiki/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  慕课教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  菜鸟教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/blog/tutorial/03.印记中文.html" class="nav-link">
  印记中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/web/browser/03.html#浏览器端发起-http-请求流程" class="sidebar-link">浏览器端发起 HTTP 请求流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_1-构建请求" class="sidebar-link">1. 构建请求</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_2-查找缓存" class="sidebar-link">2. 查找缓存</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_3-准备-ip-地址和端口" class="sidebar-link">3. 准备 IP 地址和端口</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_4-等待-tcp-队列" class="sidebar-link">4. 等待 TCP 队列</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_5-建立-tcp-连接" class="sidebar-link">5. 建立 TCP 连接</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_6-发送-http-请求" class="sidebar-link">6. 发送 HTTP 请求</a></li></ul></li><li><a href="/blog/web/browser/03.html#服务器端处理-http-请求流程" class="sidebar-link">服务器端处理 HTTP 请求流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_1-返回请求" class="sidebar-link">1. 返回请求</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_2-断开连接" class="sidebar-link">2. 断开连接</a></li><li class="sidebar-sub-header"><a href="/blog/web/browser/03.html#_3-重定向" class="sidebar-link">3. 重定向</a></li></ul></li><li><a href="/blog/web/browser/03.html#问题解答" class="sidebar-link">问题解答</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/web/browser/03.html#总结" class="sidebar-link">总结</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/web/browser/03.html#精选留言" class="sidebar-link">精选留言</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>HTTP 是一种允许浏览器向服务器获取资源的协议，是 Web 的基础，HTTP 也是浏览器使用最广的协议，所以要想学好浏览器，就要先深入了解 HTTP。</p> <h2 id="浏览器端发起-http-请求流程"><a href="#浏览器端发起-http-请求流程" class="header-anchor">#</a> 浏览器端发起 HTTP 请求流程</h2> <p>如果你在浏览器地址栏里键入极客时间网站的地址：<code>http://time.geekbang.org/index.html</code>， 浏览器会完成哪些动作呢？</p> <h3 id="_1-构建请求"><a href="#_1-构建请求" class="header-anchor">#</a> 1. 构建请求</h3> <p>首先，浏览器构建请求行信息（如下所示），构建好后，浏览器准备发起网络请求。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>GET /index.html HTTP1.1
</code></pre></div><h3 id="_2-查找缓存"><a href="#_2-查找缓存" class="header-anchor">#</a> 2. 查找缓存</h3> <p>在真正发起网络请求之前，浏览器会先在浏览器缓存中查询是否有要请求的文件。</p> <p><strong>浏览器缓存是一种在本地保存资源副本，以供下次请求时直接使用的技术。</strong></p> <h3 id="_3-准备-ip-地址和端口"><a href="#_3-准备-ip-地址和端口" class="header-anchor">#</a> 3. 准备 IP 地址和端口</h3> <p>1、浏览器使用 <code>HTTP 协议作为应用层协议</code>，用来封装请求的文本信息；</p> <p>2、并使用 <code>TCP/IP 作传输层协议</code>将它发到网络上。</p> <p>所以在 HTTP 工作开始之前，浏览器需要通过 TCP 与服务器建立连接。也就是说 <code>HTTP 的内容是通过 TCP 的传输数据阶段来实现的</code>。</p> <p>如图：TCP 和 HTTP 的关系示意图</p> <p><img src="https://img-blog.csdnimg.cn/20201109173200871.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>浏览器会请求 DNS 返回域名对应的 IP。</p> <p>浏览器还提供了 DNS 数据缓存服务。</p> <h3 id="_4-等待-tcp-队列"><a href="#_4-等待-tcp-队列" class="header-anchor">#</a> 4. 等待 TCP 队列</h3> <p>Chrome 有个机制，同一个域名同时最多只能建立 6 个 TCP 连接，如果在同一个域名下同时有 10 个请求发生，那么其中 4 个请求会进入排队等待状态，直至进行中的请求完成。</p> <p>如果当前请求数量少于 6，会直接进入下一步，建立 TCP 连接。</p> <blockquote><p>引用：“Geek_870e7d
：http/1.1 一个 tcp 同时只能处理一个请求，浏览器会为每个域名维护 6 个 tcp 连接！ 但是每个 tcp 连接是可以复用的，也就是处理完一个请求之后，不断开这个 tcp 连接，可以用来处理下个 http 请求！ 不过 http2 是可以并行请求资源的，所以如果使用 http2，浏览器只会为每个域名维护一个 tcp 连接”</p></blockquote> <h3 id="_5-建立-tcp-连接"><a href="#_5-建立-tcp-连接" class="header-anchor">#</a> 5. 建立 TCP 连接</h3> <p>有兴趣的：这个部分可以看第二讲</p> <h3 id="_6-发送-http-请求"><a href="#_6-发送-http-请求" class="header-anchor">#</a> 6. 发送 HTTP 请求</h3> <p>首先浏览器会向服务器发送请求行，它包括了<code>请求方法</code>、<code>请求 URI（Uniform Resource Identifier）</code>和 <code>HTTP 版本协议</code>。</p> <p>HTTP 请求数据格式：</p> <p><img src="https://img-blog.csdnimg.cn/20201109173239272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="服务器端处理-http-请求流程"><a href="#服务器端处理-http-请求流程" class="header-anchor">#</a> 服务器端处理 HTTP 请求流程</h2> <h3 id="_1-返回请求"><a href="#_1-返回请求" class="header-anchor">#</a> 1. 返回请求</h3> <p>首先服务器会返回<code>响应行</code>，包括协议版本和状态码。</p> <p>服务器响应的数据格式:</p> <p><img src="https://img-blog.csdnimg.cn/20201109173255713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>可以通过工具软件 <code>curl</code> 来查看返回请求数据：（<a href="http://www.ruanyifeng.com/blog/2011/09/curl.html" target="_blank" rel="noopener noreferrer">【curl 网站开发指南-阮一峰的网络日志
】<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -i https://time.geekbang.org/
</code></pre></div><p><code>-i</code> 是为了返回响应行、响应头和响应体的数据。</p> <h3 id="_2-断开连接"><a href="#_2-断开连接" class="header-anchor">#</a> 2. 断开连接</h3> <p>通常情况下，一旦服务器向客户端返回了请求数据，它就要关闭 TCP 连接。</p> <p>如果浏览器或者服务器在其头信息中加入了：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Connection:Keep-Alive
</code></pre></div><p>那么 TCP 连接在发送后将仍然保持打开状态。</p> <p><strong>保持 TCP 连接可以省去下次请求时需要建立连接的时间，提升资源加载速度。</strong></p> <h3 id="_3-重定向"><a href="#_3-重定向" class="header-anchor">#</a> 3. 重定向</h3> <p>当你在浏览器中打开 <code>geekbang.org</code> 后，你会发现最终打开的页面地址是 <code>https://www.geekbang.org</code>。</p> <p>这两个 URL 之所以不一样，是因为涉及到了一个<code>重定向操作</code>。</p> <p>在控制台输入如下命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -I geekbang.org
</code></pre></div><p><code>-I</code> 表示只需要获取响应头和响应行数据。</p> <p>服务器返回响应行和响应头（含重定向格式）:</p> <p><img src="https://img-blog.csdnimg.cn/20201109173313924.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <ul><li>响应行返回的状态码是 301</li> <li>状态 301 就是告诉浏览器，需要重定向到另外一个网址</li> <li>需要重定向的网址正是包含在响应头的 Location 字段中</li></ul> <h2 id="问题解答"><a href="#问题解答" class="header-anchor">#</a> 问题解答</h2> <p><strong>1. 为什么很多站点第二次打开速度会很快？</strong></p> <p>解答：主要原因是这些网站把很多资源都缓存在了本地，浏览器缓存直接使用本地副本来回应请求，而不会产生真实的网络请求，从而节省了时间。同时，DNS 数据也被浏览器缓存了，这又省去了 DNS 查询环节。</p> <p><strong>DNS 缓存和页面资源缓存这两块数据是会被浏览器缓存的。</strong></p> <p>1）、DNS 缓存比较简单，它主要就是在浏览器本地把对应的 IP 和域名关联起来。</p> <p>2）、重点看下浏览器资源缓存，下面是缓存处理的过程：</p> <p><img src="https://img-blog.csdnimg.cn/20201109173354181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <p>浏览器是通过响应头中的 <code>Cache-Control</code> 字段来设置是否缓存该资源。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Cache-Control:Max-age<span class="token operator">=</span><span class="token number">2000</span>
</code></pre></div><p>上面表示：缓存过期时间是 2000 秒。</p> <p>如果缓存过期了，浏览器则会继续发起网络请求，并且在 HTTP 请求头中带上：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>If-None-Match: <span class="token string">&quot;4f80f-13c-3a1xb12a&quot;</span>
</code></pre></div><p>服务器收到请求头后，会根据 <strong><code>If-None-Match</code> 的值来判断请求的资源是否有更新</strong>。</p> <ul><li>如果没有更新，就返回 304 状态码，相当于服务器告诉浏览器：“这个缓存可以继续使用，这次就不重复发送数据给你了。”</li> <li>如果资源有更新，服务器就直接返回最新资源给浏览器。</li></ul> <p>更多的 HTTP 缓存参考链接：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ" target="_blank" rel="noopener noreferrer">HTTP 缓存-MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>2. 登录状态是如何保持的？</strong></p> <p>解答：如果服务器端发送的响应头内有 <code>Set-Cookie</code> 的字段，那么浏览器就会将该字段的内容保持到本地。当下次客户端再往该服务器发送请求时，客户端会自动在请求头中加入 Cookie 值后再发送出去。服务器端发现客户端发送过来的 Cookie 后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到该用户的状态信息。</p> <p>1）、当用户登录信息正确，会生成一段表示用户身份的字符串，并把该字符串写到响应头的 Set-Cookie 字段里，然后把响应头发送给浏览器。</p> <p>比如下面所示：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Set-Cookie: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span>3431uad<span class="token punctuation">;</span>
</code></pre></div><p>2）、浏览器在接收到服务器的响应头后，开始解析响应头，如果遇到响应头里含有 <code>Set-Cookie</code> 字段的情况，浏览器就会把这个字段信息保存到本地。</p> <p>比如把上面的 <code>UID=3431uad</code> 保存到本地。</p> <p>3）、当用户再次访问时，浏览器会发起 HTTP 请求，但在发起请求之前，浏览器会读取之前保存的 Cookie 数据，并把数据写进请求头里的 Cookie 字段里，然后浏览器再将请求头发送给服务器。</p> <p>比如下面所示：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Cookie: <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span>3431uad<span class="token punctuation">;</span>
</code></pre></div><p>4）、服务器在收到 HTTP 请求头数据之后，就会查找请求头里面的 “Cookie” 字段信息，当查找到包含 <code>UID=3431uad</code> 的信息时，服务器查询后台，并判断该用户是已登录状态，然后生成含有该用户信息的页面数据，并把生成的数据发送给浏览器。</p> <p>Cookie 流程图:</p> <p><img src="https://img-blog.csdnimg.cn/20201109173426119.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>HTTP 请求流程示意图:</p> <p><img src="https://img-blog.csdnimg.cn/20201109173440342.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaW1vMzEz,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="精选留言"><a href="#精选留言" class="header-anchor">#</a> 精选留言</h2> <p>1、老师，同一个域名同时最多只能建立 6 个 TCP 连接 是不是意思是统一域名同时只能发送 6 个 AJAX 请求吗， TCP 连接和 AJAX 请求有什么关系吗？</p> <blockquote><p>作者回复: 首先回答第一个问题：
”同一个域名同时最多只能建立 6 个 TCP 连接“ 指的不光是指 Ajax，还包括页面中的资源加载，只要是一个域名下的资源，浏览器同一时刻最多只支持 6 个并行请求。
不过这是 HTTP/1.1 的规则，HTTP/2 已经不用这套规则了，而且 HTTP/2 也很成熟了，有条件可以考虑切换到 HTTP/2.
Ajax 其实就是 HTTP 请求，包括了 XMLHttpRequest 和 Fetch，HTTP 请求是建立在 TCP 协议之上的。</p></blockquote> <p>2、老师，请问 https 为什么能防止网络劫持？</p> <blockquote><p>作者回复: http 在传输过程中是明文的，所以数据在传输过程中是能够被截获或者修改的，比如谁在你电脑上安装了一个网络拦截软件，或者你的路由器被谁安装了监听软件，甚至在网络服务提供商都有可能修改你页面的内容，基于这些原因，我们需要在传输过程中加密数据，这就是 https 出现的原因，即便你拦截到了请求，获取的只是加密后的数据，拿到也没有什么用。
这块在浏览器安全篇会系统介绍。</p></blockquote> <p>3、老师您好~有个问题困扰我了。希望您能解答我，十分感谢。http2 同个域名只能维持一个长连接。那我现在打开了一个域名下的 a 页面，然后又打开了这个域名的 b 页面，那这个 b 页面是新开一个 tcp 长连接吗？还是会用 a 页面的长连接？换句话说，维持一个 tcp 长连接，指的是一个页面维持一个？还是整个浏览器维持一个？还是同一个渲染进程维持一个？</p> <blockquote><p>作者回复: 浏览器为用同一个域名只维护一个 TCP 连接。
你从通过 Chrome 打开 <code>chrome://net-export/</code> 这个地址，然后记录网络过程。
最后在使用这个 <code>https://netlog-viewer.appspot.com/</code> 打开你日志文件，就能看到 h2 的详细信息了。</p></blockquote> <p>4、浏览器刷新操作，ctrl+F5 和 F5 有什么区别？</p> <div class="language-txt extra-class"><pre class="language-txt"><code>作者回复: 一个是强制刷新，也就是资源都走网络。

一个是正常处理流程。

比如通过网络面板，打开一个站点，再使用强制刷新，可以看到如下信息
176 requests
3.1 MB transferred
3.5 MB resources
Finish: 26.30 s
DOMContentLoaded: 5.04 s
Load: 14.88 s

如果使用正常的刷新，看到的信息如下：
171 requests
419 KB transferred
3.2 MB resources
Finish: 25.09 s
DOMContentLoaded: 1.41 s
Load: 6.24 s

其中的 transferred 是真正的网络传输的数据，使用强制刷新，传输的数据体积就大多了，而且请求时间也变得更长了。
</code></pre></div><p>5、set cookie 会不会有安全问题，麻烦老师指导下</p> <blockquote><p>作者回复: cookie 是不安全的，比如黑客可以通过一些手段插入一些脚本到你的页面里面（具体一些途径我们浏览器安全篇再讲），通过脚本获取到你的 cookie 数据，然后就可以利用 cookie 做一些坏事了。
当然也有一些方法规避，常用的一个是将部分 cookie 设置成 httponly 的属性，设置了 httponly 属性后 cookie，就无法通过 js 脚本来读取了，只是在发送 http 请求时候会被带上！
当然还有一些其他防范的方法，这个同样咱们后面在聊！</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.984fdec4.js" defer></script><script src="/assets/js/2.f6007b26.js" defer></script><script src="/assets/js/49.22b61fb9.js" defer></script>
  </body>
</html>
